<section class="row outerpadding ml-10 mr-10">
  <div class="col-12">
    <div class="row">
      <div class="col-12">
        <div class="card mt-5">

          <div class="tab-content" id="pills-tabContent">
            <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
              <h4 class="card-hedding dotted-bottom">Person Details</h4>

              <!-- <div class="col-12  search-eidted-p padding-15"
        *ngIf="(member.membershipTypeCode == null || member.termEndDate == null || member.termStartDate == null) && isMandatoryFiled == true">
        <div class="alert alert-warning txt-medium">Fill person details
        </div>
      </div> -->
              <div class="col-md-12" *ngIf="isNewMember">
                <div class="form-group">
                  <div class="form-check-inline">
                    <label class="form-check-label">
                      <input type="radio" class="form-check-input" name="empOptradio" value="employee" [(ngModel)]="personType" (ngModelChange)="changePersonType(personType)">
                      <span class="txt-medium text-secondary">Employee</span>
                    </label>
                  </div>
                  <div class="form-check-inline">
                    <label class="form-check-label">
                      <input type="radio" class="form-check-input" name="nonEmpOptradio" value="non-employee" [(ngModel)]="personType" (ngModelChange)="changePersonType(personType)">
                      <span class="txt-medium text-secondary">Non-Employee</span>
                    </label>
                  </div>
                  <app-elastic [options]="options" [placeHolder]="elasticPlaceHolder" [clearField]="clearField" (selectedResult)="selectPersonElasticResult($event)"></app-elastic>
                </div>
              </div>

              <div class="col-12  search-eidted-p padding-15" *ngIf="isMandatoryFiled == false">
                <div class="alert alert-danger txt-medium" [innerHTML]="warningMessage">
                </div>
              </div>

              <div class="col-12">
                <div>
                  <div class="col-12  search-eidted-p padding-15 pt-1">
                    <div class="row">
                      <div class="col-12">
                        <div class="row">
                          <div class="col-12 card search-card-view mb-2 mt-0 p-3">
                            <div class="row">
                              <div class="col-4">
                                <span class="txt-medium text-secondary">Person Name:</span>
                                <span class="txt-medium text-danger">{{selectedPerson?.fullName}}</span>
                              </div>
                              <div class="col-4">
                                <span class="txt-medium text-secondary">Email:</span>
                                <span class="txt-medium text-danger">{{selectedPerson?.emailAddress}}</span>
                              </div>
                              <div class="col-4">
                                <span class="txt-medium text-secondary">Title:</span>
                                <span class="txt-medium text-danger" *ngIf="memberDetails.nonEmployeeFlag">{{selectedPerson?.title}}</span>
                                <span class="txt-medium text-danger" *ngIf="!memberDetails.nonEmployeeFlag">{{selectedPerson?.directoryTitle}}</span>
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-4">
                                <span class="txt-medium text-secondary">Unit:</span>
                                <span class="txt-medium text-danger" *ngIf="memberDetails.nonEmployeeFlag">{{selectedPerson?.organization}}</span>
                                <span class="txt-medium text-danger" *ngIf="!memberDetails.nonEmployeeFlag">{{selectedPerson?.unitName}}</span>
                              </div>
                              <div class="col-4">
                                <span class="txt-medium text-secondary">Address:</span>
                                <span class="txt-medium text-danger">{{selectedPerson?.addressLine1}}</span>
                              </div>
                              <div class="col-4">
                                <span class="txt-medium text-secondary">Phone:</span>
                                <span class="txt-medium text-danger">{{selectedPerson?.phoneNumber}}</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="form-group ">
                          <span class="txt-medium text-secondary">Membership Type
                          </span>
                          <select id="membershipType" class="custom-select txt-small form-control mr-sm-2" [(ngModel)]="memberDetails.membershipTypeCode"
                            (ngModelChange)="setMembershipType(memberDetails.membershipTypeCode)">
                            <option *ngFor="let type of memberShipTypes" value="{{type.membershipTypeCode}}">{{type.description}}
                            </option>


                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="form-group">
                          <span class="txt-medium text-secondary">Term Start Date
                            <span class="mandatory">*</span>
                          </span>
                          <div class="input-group  mb-2">
                            <input type="text" class="form-control txt-small" [owlDateTime]="dt1" placeholder="mm/dd/yyyy" [(ngModel)]="memberDetails.termStartDate">
                            <owl-date-time [pickerType]="'calendar'" #dt1></owl-date-time>
                            <div class="input-group-append" [owlDateTimeTrigger]="dt1">
                              <span class="input-group-text">
                                <i class="fa fa-calendar" aria-hidden="true"></i>
                              </span>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="form-group">
                          <span class="txt-medium text-secondary">Term End Date
                            <span class="mandatory">*</span>
                          </span>
                          <div class="input-group  mb-2">
                            <input type="text" class="form-control txt-small" [owlDateTime]="dt2" placeholder="mm/dd/yyyy" [(ngModel)]="memberDetails.termEndDate">
                            <owl-date-time [pickerType]="'calendar'" #dt2></owl-date-time>
                            <div class="input-group-append" [owlDateTimeTrigger]="dt2">
                              <span class="input-group-text">
                                <i class="fa fa-calendar" aria-hidden="true"></i>
                              </span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                  </div>
                </div>
                <div class="col-12" *ngIf="isNewMember">
                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group">
                        <span class="txt-medium text-secondary">Role
                          <span class="mandatory">*</span>
                        </span>
                        <ng2-completer title="Enter Role" [placeholder]="'Enter Role'" [openOnFocus]="true" [(ngModel)]="committeeMemberRole.membershipRoleDescription"
                          [inputClass]="'form-control'" [datasource]="roleTypes" [minSearchLength]="0" (selected)="setMemberRole($event)"></ng2-completer>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group">
                        <span class="txt-medium text-secondary">Start Date
                          <span class="mandatory">*</span>
                        </span>
                        <div class="input-group">
                          <input type="text" class="form-control txt-small" [(ngModel)]="committeeMemberRole.startDate" [owlDateTime]="dt5" placeholder="mm/dd/yyyy">
                          <owl-date-time [pickerType]="'calendar'" #dt5></owl-date-time>
                          <div class="input-group-append" [owlDateTimeTrigger]="dt5">
                            <span class="input-group-text">
                              <i class="fa fa-calendar" aria-hidden="true"></i>
                            </span>
                          </div>
                        </div>
                        <!-- <div class="input-group  mb-2">
                    <input type="text" class="form-control" [owlDateTime]="dt3" placeholder="mm/dd/yyyy"
                      [(ngModel)]="memberRoleObject.startDate" [disabled]="addRole==false">
                    <owl-date-time [pickerType]="'calendar'" #dt3></owl-date-time>
                    <div class="input-group-append" [owlDateTimeTrigger]="dt3">
                      <span class="input-group-text input-span-1">
                        <i class="fa fa-calendar" aria-hidden="true"></i>
                      </span>
                    </div>
                  </div> -->
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group">
                        <span class="txt-medium text-secondary">End Date
                          <span class="mandatory">*</span>
                        </span>

                        <div class="input-group">
                          <input type="text" class="form-control txt-small" [(ngModel)]="committeeMemberRole.endDate" [owlDateTime]="dt6" placeholder="mm/dd/yyyy">
                          <owl-date-time [pickerType]="'calendar'" #dt6></owl-date-time>
                          <div class="input-group-append" [owlDateTimeTrigger]="dt6">
                            <span class="input-group-text">
                              <i class="fa fa-calendar" aria-hidden="true"></i>
                            </span>
                          </div>
                        </div>
                        <!-- <div class="input-group  mb-2">
                    <input type="text" class="form-control" [owlDateTime]="dt4" placeholder="mm/dd/yyyy"
                      [(ngModel)]="memberRoleObject.endDate" [disabled]="addRole==false">
                    <owl-date-time [pickerType]="'calendar'" #dt4></owl-date-time>
                    <div class="input-group-append" [owlDateTimeTrigger]="dt4">
                      <span class="input-group-text input-span-1">
                        <i class="fa fa-calendar" aria-hidden="true"></i>
                      </span>
                    </div>
                  </div> -->
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-12">
                  <div class="row">
                    <div class="col-6">
                      <div class="form-group ">
                        <span class="txt-medium text-secondary">Contact Notes
                        </span>
                        <textarea class="form-control txt-area-fnt txt-small" id="contactNotes" [(ngModel)]="memberDetails.contactNotes"></textarea>
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="form-group ">
                        <span class="txt-medium text-secondary">Training Notes
                        </span>
                        <textarea class="form-control txt-area-fnt txt-small" id="trainingNotes" [(ngModel)]="memberDetails.trainingNotes"></textarea>
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="row bottom-margin">
                        <div class="col-md-12">
                          <button type="button margin-class" class="btn btn-outline-success txt-small btn-size" (click)="saveMemberDetails()" style="float: right">
                            <span>Save</span>
                          </button>
                        </div>
                      </div>
                    </div>

                  </div>
                </div>
                <!-- <div *ngIf="isMandatoryFiled == false">
                                                              <span class="mandatory">{{warningMessage}}</span>
                                                            </div> -->
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-12" *ngIf="!isNewMember">
    <div class="row">
      <div class="col-8">
        <div class="card mt-3">
          <div class="tab-content" id="pills-tabContent">
            <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
              <h4 class="card-hedding dotted-bottom">Roles</h4>
              <div class="col-12  search-eidted-p padding-15" *ngIf="isRoleMandatoryFiled == false">
                <div class="alert alert-danger txt-medium" [innerHTML]="warningMessage">
                </div>
              </div>

              <!-- ROLES -->
              <div class="col-12">
                <div>
                  <div class="col-12">

                    <div class="row">
                      <div class="col-md-4">
                        <div class="form-group ">
                          <span class="txt-medium text-secondary">Role
                            <span class="mandatory">*</span>
                          </span>
                          <ng2-completer [placeholder]="'Enter Role'" [openOnFocus]="true" [(ngModel)]="committeeMemberRole.membershipRoleDescription"
                            [inputClass]="'form-control pr-0'" [datasource]="roleTypes" [minSearchLength]="0" (selected)="setMemberRole($event)"></ng2-completer>
                        </div>
                      </div>
                      <div class="col-md-3">
                        <div class="form-group">
                          <span class="txt-medium text-secondary">Start Date
                            <span class="mandatory">*</span>
                          </span>
                          <div class="input-group">
                            <input type="text" class="form-control txt-small" [(ngModel)]="committeeMemberRole.startDate" [owlDateTime]="dt3" placeholder="mm/dd/yyyy">
                            <owl-date-time [pickerType]="'calendar'" #dt3></owl-date-time>
                            <div class="input-group-append" [owlDateTimeTrigger]="dt3">
                              <span class="input-group-text">
                                <i class="fa fa-calendar" aria-hidden="true"></i>
                              </span>
                            </div>
                          </div>
                          <!-- <div class="input-group  mb-2">
                              <input type="text" class="form-control" [owlDateTime]="dt3" placeholder="mm/dd/yyyy"
                                [(ngModel)]="memberRoleObject.startDate" [disabled]="addRole==false">
                              <owl-date-time [pickerType]="'calendar'" #dt3></owl-date-time>
                              <div class="input-group-append" [owlDateTimeTrigger]="dt3">
                                <span class="input-group-text input-span-1">
                                  <i class="fa fa-calendar" aria-hidden="true"></i>
                                </span>
                              </div>
                            </div> -->
                        </div>
                      </div>
                      <div class="col-md-3">
                        <div class="form-group">
                          <span class="txt-medium text-secondary">End Date
                            <span class="mandatory">*</span>
                          </span>

                          <div class="input-group">
                            <input type="text" class="form-control txt-small" [(ngModel)]="committeeMemberRole.endDate" [owlDateTime]="dt4" placeholder="mm/dd/yyyy">
                            <owl-date-time [pickerType]="'calendar'" #dt4></owl-date-time>
                            <div class="input-group-append" [owlDateTimeTrigger]="dt4">
                              <span class="input-group-text">
                                <i class="fa fa-calendar" aria-hidden="true"></i>
                              </span>
                            </div>
                          </div>
                          <!-- <div class="input-group  mb-2">
                              <input type="text" class="form-control" [owlDateTime]="dt4" placeholder="mm/dd/yyyy"
                                [(ngModel)]="memberRoleObject.endDate" [disabled]="addRole==false">
                              <owl-date-time [pickerType]="'calendar'" #dt4></owl-date-time>
                              <div class="input-group-append" [owlDateTimeTrigger]="dt4">
                                <span class="input-group-text input-span-1">
                                  <i class="fa fa-calendar" aria-hidden="true"></i>
                                </span>
                              </div>
                            </div> -->
                        </div>
                      </div>
                      <div class="col-md-2">
                        <button title="Add" (click)="addMemberRole()" type="button" class="btn btn-outline-success txt-small btn-size mt-25">
                          Add
                        </button>
                      </div>
                    </div>

                  </div>
                  <!-- <div *ngIf="roleFieldsFilled == false">
                                                                        <span class="mandatory">{{warningMessage}}</span>
                                                                    </div> -->
                  <div class="table-responsive mb-15" *ngIf="memberRoleList?.length > 0">
                    <table class="table table-striped tbl-p-clr table-padding">
                      <thead class="tbl-head-clr thead-font-size">
                        <tr>
                          <th scope="col"> Role</th>
                          <th scope="col" width="30%">Start Date</th>
                          <th scope="col" width="30%">End Date</th>
                          <th scope="col" width="15%">Action</th>
                        </tr>
                      </thead>
                      <tbody class="tbody-font-size">
                        <tr *ngFor="let role of  memberRoleList;let i=index">
                          <td>{{role.membershipRoleDescription}}</td>
                          <td width="30%">
                            <div class="form-group" *ngIf="editRoleIndex == i">
                              <div class="input-group  mb-2">
                                <input type="text" class="form-control" [owlDateTime]="dt9" placeholder="mm/dd/yyyy" [(ngModel)]="committeeMemberRoleEdit.startDate"
                                  [(ngModel)]="role.startDate" [min]="memberDetails.termStartDate" [max]="memberDetails.termEndDate"
                                  #dateTime="ngModel">
                                <owl-date-time [pickerType]="'calendar'" #dt9></owl-date-time>
                                <div class="input-group-append" [owlDateTimeTrigger]="dt9">
                                  <span class="input-group-text input-span-1">
                                    <i class="fa fa-calendar" aria-hidden="true"></i>
                                  </span>
                                </div>
                              </div>
                            </div>
                            <div *ngIf="editRoleIndex != i">
                              {{role?.startDate | date: 'MM/dd/yyyy' }}</div>
                          </td>
                          <td width="30%">
                            <div class="form-group" *ngIf="editRoleIndex == i">
                              <div class="input-group  mb-2">
                                <input type="text" class="form-control" [owlDateTime]="dt10" placeholder="mm/dd/yyyy" [(ngModel)]="committeeMemberRoleEdit.endDate"
                                  [(ngModel)]="role.endDate" [min]="memberDetails.termStartDate" [max]="memberDetails.termEndDate">
                                <owl-date-time [pickerType]="'calendar'" #dt10></owl-date-time>
                                <div class="input-group-append" [owlDateTimeTrigger]="dt10">
                                  <span class="input-group-text input-span-1">
                                    <i class="fa fa-calendar" aria-hidden="true"></i>
                                  </span>
                                </div>
                              </div>
                            </div>
                            <div *ngIf="editRoleIndex != i">
                              {{role?.endDate | date: 'MM/dd/yyyy' }}</div>
                          </td>
                          <td width="15%" class="action-btn-list align-middle">
                            <button *ngIf="editRoleIndex != i" title="Edit" type="button" class="btn mb-3" (click)="editMemberRole(role,i)">
                              <i class="fa fa-pencil log-user-icon-lite" aria-hidden="true"></i>
                            </button>
                            <button *ngIf="editRoleIndex == i" title="Save" type="button" class="btn mb-3" (click)="saveMemberRole(committeeMemberRoleEdit)">
                              <i class="fa fa-floppy-o log-user-icon-lite" aria-hidden="true"></i>
                            </button>
                            <button title="Delete" type="button" class="btn mb-3" (click)="checkCanDelete(i)">
                              <i class="fa fa-trash log-user-icon-lite" aria-hidden="true"></i>
                            </button>
                          </td>

                        </tr>
                    </table>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
      <div class="col-4" *ngIf="!isNewMember">
        <div class="card mt-3">
          <div class="tab-content" id="pills-tabContent">
            <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
              <h4 class="card-hedding dotted-bottom">Expertise</h4>
              <div class="col-12  search-eidted-p padding-15" *ngIf="isExpertiseMandatoryFiled == false">
                <div class="alert alert-danger txt-medium" [innerHTML]="warningMessage">
                </div>
              </div>
              <div class="col-12">
                <div>
                  <div class="col-12">
                    <div class="row">
                      <div class="col-md-9">
                        <div class="form-group ">
                          <span class="txt-medium text-secondary">Expertise In
                            <span class="mandatory">*</span>
                          </span>
                          <input type="text" class="form-control input-field-size pr-0" placeholder="Enter Area of Expertise" [(ngModel)]="committeeMemberExpertise.researchAreaDescription"
                            (ngModelChange)="getExpertiseList()" (focus)="isExpertiseSearch = true" (focusout)="isExpertiseSearch = false"
                            (keydown.arrowdown)="keyPressEvent.onKeyDown($event,'expertiseActiveDropDown')" (keydown.arrowup)="keyPressEvent.onKeyDown($event,'expertiseActiveDropDown')"
                            (keydown.Enter)="keyPressEvent.onKeyDown($event,'expertiseActiveDropDown')">
                          <div class="sb-seachresults top-margin search-dropdown-position dropdown-width" id="expertiseActiveDropDown">
                            <ul class="sb-results-dropdown-menu search-position-fix-medium box-shadow-1 block" *ngIf="isExpertiseSearch">
                              <li class="block" *ngFor="let result of expertiseSearchResult" (mousedown)="expertiseSelected(result.description)" (click)="expertiseSelected(result.description)">
                                <a [innerHTML]="result.description"></a>
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-2">
                        <button title="Add" (click)="addExpertise()" type="button" class="btn btn-outline-success txt-small btn-size mt-25">
                          Add
                        </button>


                      </div>
                    </div>

                  </div>
                  <!-- <div *ngIf="roleFieldsFilled == false">
                                                              <span class="mandatory">{{warningMessage}}</span>
                                                          </div> -->
                  <div class="table-responsive" *ngIf="memberExpertiseList?.length > 0">
                    <table class="table table-striped tbl-p-clr table-padding">
                      <thead class="tbl-head-clr thead-font-size">
                        <tr>
                          <th scope="col"> Code</th>
                          <th scope="col">Area of Expertise </th>
                          <th scope="col">Action</th>
                        </tr>
                      </thead>
                      <tbody class="tbody-font-size">
                        <tr *ngFor="let expertise of  memberExpertiseList;let i=index">
                          <td>{{expertise.researchAreaCode}}</td>

                          <td>{{expertise.researchAreaDescription}}</td>
                          <td class="action-btn-list align-middle">
                            <button title="Delete" type="button" class="btn mb-3" (click)="deleteExpertiseIndex = i" data-toggle="modal" data-target="#deleteExpertiseModal">
                              <i class="fa fa-trash log-user-icon-lite" aria-hidden="true"></i>
                            </button>
                          </td>

                        </tr>
                    </table>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>




    </div>
  </div>
</section>

<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalTitle" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header popup-header dotted-bottom">
        <h5 class="modal-title text-black thick txt-large" id="exampleModalLongTitle">Want to delete?
        </h5>
        <button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body modal-pop-up dotted-bottom txt-medium">
        <p>
          Are you sure you want to delete this role ?
        </p>

      </div>
      <div class="modal-footer btn-row-med p-2">
        <button type="button margin-class" class="btn btn-outline-danger txt-small" data-dismiss="modal">No</button>
        <button type="button margin-class" class="btn btn-outline-success txt-small" (click)="deleteMemberRole()" data-dismiss="modal">Yes</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="deleteExpertiseModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalTitle" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header popup-header dotted-bottom">
        <h5 class="modal-title text-black thick txt-large" id="exampleModalLongTitle">Want to delete?
        </h5>
        <button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body modal-pop-up dotted-bottom txt-medium">
        <p>
          Are you sure you want to delete this area of expertise ?
        </p>

      </div>
      <div class="modal-footer btn-row-med p-2">
        <button type="button margin-class" class="btn btn-outline-danger txt-small" data-dismiss="modal">No</button>
        <button type="button margin-class" class="btn btn-outline-success txt-small" (click)="deleteMemberExpertise()" data-dismiss="modal">Yes</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="roleDeleteWarningModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalTitle" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header popup-header dotted-bottom">
        <h5 class="modal-title text-black thick txt-large" id="exampleModalLongTitle">Cannot Delete
        </h5>
        <button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body modal-pop-up dotted-bottom txt-medium">
        <p>
          Atleast One Role is Mandatory
        </p>

      </div>
      <div class="modal-footer btn-row-med p-2">
        <button type="button margin-class" class="btn btn-outline-danger txt-small" data-dismiss="modal">Ok</button>

      </div>
    </div>
  </div>
</div>

<button id="roleDeleteWarningBtn" [hidden]="true" data-toggle="modal" data-target="#roleDeleteWarningModal"></button>
<button id="deleteModalBtn" [hidden]="true" data-toggle="modal" data-target="#deleteModal"></button>