<!-- tinu edit start-->
<div class="" *ngIf="isGeneralInfoSaved">
    <div class="row">
      <!--collapse-->
  
  
      <div class="col-12">
        <div class="row cards-in">
          <div class="col-12 mb-10">
            <div class="card mt-5">
  
              <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                  <h4 class="card-hedding dotted-bottom">Protocol Units
                  </h4>
                </div>
              </div>
  
              <div class="card-body card-paddng">
                  <div class="col-12  search-eidted-p padding-15" *ngIf="invalidData.invalidUnitData">
                    <div class="alert alert-danger" [innerHTML]="alertMessage">
                      <strong>*</strong>
                    </div>
                  </div>
                  <div class="col-12  search-eidted-p" *ngIf="isUnitInfoEditable">
  
                    <div class="row top-dis-15">
                      <div class="col-md-4">
                        <div class="form-group">
                          <span class="txt-medium txt-dark">Department
                            <span class="mandatory">*</span>
                          </span>
                          <input type="text" [class.poping-border]="isProtocolUnitEdit" class="txt-small form-control" placeholder="Search Unit"
                            [(ngModel)]="protocolUnit.unitName" (ngModelChange)="getHomeUnitList()" (focus)="isProtocolUnitSearch = true"
                            (focusout)="isProtocolUnitSearch = false" (keydown.arrowdown)="keyPressEvent.onKeyDown($event,'protocolUnitDropDown')"
                            (keydown.arrowup)="keyPressEvent.onKeyDown($event,'protocolUnitDropDown')" (keydown.Enter)="keyPressEvent.onKeyDown($event,'protocolUnitDropDown')">
                          <div class="sb-seachresults top-margin search-dropdown-position dropdown-width" id="protocolUnitDropDown">
                            <ul class="sb-results-dropdown-menu1 search-position-fix-small box-shadow-1" *ngIf="isProtocolUnitSearch">
                              <li *ngFor="let result of unitSearchResult" (mousedown)="selectedHomeUnit(result.unitName,result.unitNumber)" (click)="selectedHomeUnit(result.unitName,result.unitNumber)"
                                class="block">
                                <a>{{result.unitNumber}} - {{result.unitName}}</a>
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-3">
                        <div class="form-group">
                            <span class="txt-medium txt-dark">Type
                            <span class="mandatory">*</span>
                            </span>
                          <select [class.poping-border]="isProtocolUnitEdit" class="txt-small form-control" id="customRoleSelect" [(ngModel)]="protocolUnit.unitTypeCode"
                            (ngModelChange)="setProtocolUnitType(protocolUnit.unitTypeCode)">
                            <option selected value=null>Please Select</option>
                            <option *ngFor="let protocolUnitType of protocolUnitTypes" value="{{protocolUnitType.unitTypeCode}}">{{protocolUnitType.description}}</option>
                          </select>
                          <span *ngIf="invalidData.isLeadUnitExist" class="error">Lead Unit already exists please choose a different type</span>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="form-group">
                            <span class="txt-medium txt-dark">Description
                            <!--<span class="mandatory">*</span>-->
                            </span>
                          <input type="text" [class.poping-border]="isProtocolUnitEdit" class="txt-small form-control" placeholder="Description"
                          [(ngModel)]="protocolUnit.description">
                          <!-- <textarea [class.poping-border]="isProtocolUnitEdit" class="form-control txt-area-fnt" placeholder="Description" [(ngModel)]="protocolUnit.description"></textarea> -->
                        </div>
                      </div>
                      <div class="col-md-1 add-btn-1">
                        <button title="Add" *ngIf="!isProtocolUnitEdit" type="button" class="btn top-butn" (click)="addProtocolUnit('ADD')">
                          <i class="fa fa-plus-circle text-success half-size" aria-hidden="true"></i>
                        </button>
                        <button title="Save" *ngIf="isProtocolUnitEdit" type="button" class="btn top-butn" (click)="addProtocolUnit('EDIT')">
                          <i class="fa fa-floppy-o" aria-hidden="true"></i>
                        </button>
                      </div>
  
                    </div>
                  </div>
                  <div class="col-md-12 users-list-tbl" *ngIf="protocolUnitList.length > 0">
                    <div class="row">
                      <div class="w-100">
                        <table class="table m-0">
                          <thead class="tbl-head-clr thead-font-size solid-bottom">
                            <tr>
                              <th scope="col">Department Name</th>
                              <th scope="col">Type</th>
                              <th scope="col">Description</th>
                              <th scope="col">Action</th>
                            </tr>
                          </thead>
                          <tbody class="tbody-font-size text-secondary">
                            <tr *ngFor="let item of protocolUnitList let i =index" [class.poping-border]="i == protocolUnitSelectedRow"
                            class="solid-bottom pull-up">
                              <td class="align-middle">{{item?.unitName}}</td>
                              <td class="align-middle">{{item?.unitType?.description}}</td>
                              <td class="align-middle">{{item?.description}}</td>
                              <td class="action-btn-list align-middle">
                                <button *ngIf="isUnitInfoEditable" title="Edit" (click)="editProtocolUnit(item,i)" type="button" class="btn mb-2">
                                  <i class="fa fa-pencil log-user-icon-lite" aria-hidden="true"></i>
                                </button>
                                <!-- <button *ngIf="isProtocolUnitEdit && i == protocolUnitSelectedRow" title="Save" (click)="addProtocolUnit(item,'EDIT')"
                                    type="button" class="btn btn-primary edit-btn-1">
                                    <i class="fa fa-floppy-o" aria-hidden="true"></i>
                                  </button> -->
                                <button *ngIf="isUnitInfoEditable" title="Delete" (click)="deleteProtocolUnit(i)" type="button" class="btn mb-2" data-toggle="modal"
                                  data-target="#deleteUnitDetails">
                                  <i class="fa fa-trash log-user-icon-lite" aria-hidden="true"></i>
                                </button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
  
            </div>
          </div>
        </div>
      </div>
  
    </div>
  </div>
  
  
  <!-- tinu edit end-->
  
  
  <div class="top-distance" *ngIf="isGeneralInfoSaved">
  
  
    <!--delete warning modal-->
    <div class="modal fade mySkinDialog modalFallBack" *ngIf="showDeletePopup" id="deleteUnitDetails" tabindex="-1" role="dialog"
      aria-labelledby="deleteModalTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content modal-text-color">
          <div class="modal-header popup-header dotted-bottom">
            <h5 class="thick txt-large text-black mb-0 mt-1">Want to delete?</h5>
  
            <button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body dotted-bottom txt-medium">
            <p *ngIf="commonVo?.protocolLeadUnits?.unitType?.unitTypeCode != '1'">Are you sure you want to delete this item?</p>
            <p *ngIf="commonVo?.protocolLeadUnits?.unitType?.unitTypeCode == '1'">You cannot delete lead Unit.</p>
          </div>
          <div class="modal-footer p-2" *ngIf="commonVo?.protocolLeadUnits?.unitType?.unitTypeCode != '1'">
            <button type="button" class="btn btn-outline-danger txt-small" data-dismiss="modal" data-toggle="modal" (click)="showDeletePopup = false">No</button>
            <button type="button" class="btn btn-outline-success txt-small" (click)="saveProtocolUnit('DELETE');" data-dismiss="modal">Yes</button>
          </div>
          <div class="modal-footer p-2" *ngIf="commonVo?.protocolLeadUnits?.unitType?.unitTypeCode == '1'">
              <button type="button" class="btn btn-outline-success txt-small" data-dismiss="modal" data-toggle="modal" (click)="showDeletePopup = false">Ok</button>
            </div>
        </div>
      </div>
    </div>
